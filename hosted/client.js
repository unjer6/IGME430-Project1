(()=>{let e;const t=document.createElement("template");t.innerHTML='\n<li><div class="row align-items-center">\n  <div class="col pe-0"><input id="text" class="w-100" type="text"></div>\n  <div id="moveUp" class="col-auto px-0"><button class="btn no-focus chevron-up" type="button"></button></div>\n  <div id="moveDown" class="col-auto px-0"><button class="btn no-focus chevron-down" type="button"></button></div>\n  <div id="delete" class="col-auto px-0"><button type="button" class="no-focus btn-close" aria-label="Close"></button></div>\n</div></li>\n';const n=document.createElement("template");n.innerHTML='\n<div class="accordion-item mb-3">\n  <h2 class="accordion-header">\n    <button id="headerBtn" class="accordion-button no-focus collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#id">\n      My List\n    </button>\n  </h2>\n  <div id="accordianCollapse" class="accordion-collapse collapse">\n    <div class="accordion-body">\n\n      <div id="listHiddenForLoading" class="d-none">\n        \x3c!-- List items --\x3e\n        <ol id="itemList" class="ps-3">\n\n\n\n        </ol>\n        \n        \x3c!-- Add new item --\x3e\n        <button id="addItemBtn" class="w-100 px-4 py-1 d-flex justify-content-between align-items-center no-focus btn btn-primary" type="button">\n          <span>Add new item</span>\n          <img src="images/plus.png" width="20" height="20">\n        </button>\n        \n        <hr>\n\n        \x3c!-- Save and delete --\x3e\n        <div id="unsaved" class="d-none d-flex align-items-center justify-content-center"><strong>You have unsaved changes!</strong></div>\n        <button id="saveBtn" class="w-100 px-4 py-1 d-flex align-items-center no-focus btn btn-success" type="button">\n          <span id="saveButtonSpinner" class="d-none spinner-border spinner-border-sm me-2"></span>\n          <span id="saveSpan" class="me-auto">Save list</span>\n          <img src="images/check.png" width="20" height="20">\n        </button>\n        <button id="deleteBtn" class="w-100 mt-1 px-4 py-1 d-flex justify-content-between align-items-center no-focus btn btn-danger" type="button">\n          <span>Delete list</span>\n          <img src="images/close.png" width="20" height="20">\n        </button>\n\n      </div>\n\n      \x3c!-- Loading spinner for when we fetch the list contents --\x3e\n      <div id="listLoadingSpinner" class="d-flex justify-content-center align-items-center mt-3">\n        <div class="spinner-border" role="status" aria-hidden="true"></div>\n        <strong class="ms-3">Loading...</strong>\n      </div>\n    </div>\n  </div>\n</div>\n';const s=async(e,t,n,s,o)=>{const i={method:t,headers:{Accept:"application/json"}};s&&(i.body=s),o&&(i.headers["Content-Type"]=o),n?.(await fetch(e,i))},o=(e,n)=>{const s=t.content.cloneNode(!0).childNodes[1],o=e.querySelector("#itemList"),i=e.querySelector("#unsaved"),l=s.querySelector("#text");l.value=n??"",l.addEventListener("change",(()=>{i.classList.remove("d-none")}));const d=s.querySelector("#moveUp");d.addEventListener("click",(()=>{if(s.previousElementSibling){previousTextEl=s.previousElementSibling.querySelector("#text");const e=l.value;l.value=previousTextEl.value,previousTextEl.value=e,i.classList.remove("d-none")}})),o.firstElementChild||d.firstElementChild.classList.add("disabled");const a=s.querySelector("#moveDown");return a.addEventListener("click",(()=>{if(s.nextElementSibling){nextTextEl=s.nextElementSibling.querySelector("#text");const e=l.value;l.value=nextTextEl.value,nextTextEl.value=e,i.classList.remove("d-none")}})),a.firstElementChild.classList.add("disabled"),o.lastElementChild&&o.lastElementChild.querySelector("#moveDown").firstElementChild.classList.remove("disabled"),s.querySelector("#delete").addEventListener("click",(()=>{s.remove(),o.firstElementChild&&o.firstElementChild.querySelector("#moveUp").firstElementChild.classList.add("disabled"),o.lastElementChild&&o.lastElementChild.querySelector("#moveDown").firstElementChild.classList.add("disabled"),i.classList.remove("d-none")})),o.appendChild(s),s},i=t=>{const i=n.content.cloneNode(!0).childNodes[1],l=i.querySelector("#headerBtn"),d=i.querySelector("#accordianCollapse"),a=`id-${([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)))}`;l.dataset.bsTarget=`#${a}`,d.id=a,l.textContent=t;const c=i.querySelector("#unsaved");i.querySelector("#addItemBtn").addEventListener("click",(()=>{o(i).querySelector("#text").focus(),c.classList.remove("d-none")}));const r=i.querySelector("#saveBtn"),u=r.querySelector("#saveSpan"),v=r.querySelector("#saveButtonSpinner");let m;r.addEventListener("click",(()=>{u.textContent="Saving...",v.classList.remove("d-none"),r.classList.add("disabled"),clearTimeout(m);const e={};e.name=l.textContent,e.items=[];const t=i.querySelector("#itemList");for(let n=0;n<t.children.length;n++)e.items.push(t.children[n].querySelector("#text").value);s("/addList","POST",(()=>{v.classList.add("d-none"),r.classList.remove("disabled"),u.textContent="Saved!",m=setTimeout((()=>{u.textContent="Save list"}),2e3)}),JSON.stringify(e),"application/json"),c.classList.add("d-none")}));const p=i.querySelector("#deleteBtn"),y=p.querySelector("span");return p.addEventListener("click",(()=>{"Delete list"===y.textContent?(y.textContent="Are you sure?",setTimeout((()=>{y&&(y.textContent="Delete list")}),2e3)):(i.remove(),s(`/deleteList?name=${l.textContent}`,"DELETE",(()=>{})))})),e.appendChild(i),i};window.addEventListener("load",(()=>{e=document.querySelector("#listContainer");const t=document.querySelector("#addNewListBtn"),n=t.querySelector("input"),l=t.querySelector("span"),d=document.querySelector("#alert");t.addEventListener("click",(()=>{l.classList.add("d-none"),n.classList.remove("d-none"),n.focus()})),n.addEventListener("change",(()=>{let t=!1;if(n.value){t=!0;for(let s=0;s<e.children.length;s++)if(e.children[s].querySelector("#headerBtn").textContent===n.value){t=!1,d.classList.remove("d-none");break}}if(t){const e=i(n.value);e.querySelector("#listHiddenForLoading").classList.remove("d-none"),e.querySelector("#listLoadingSpinner").classList.add("d-none"),e.querySelector("#headerBtn").dispatchEvent(new Event("click"));const t={};t.name=n.value,t.items=[],s("/addList","POST",(()=>{}),JSON.stringify(t),"application/json"),n.value="",n.blur(),l.classList.remove("d-none"),n.classList.add("d-none"),d.classList.add("d-none")}})),n.addEventListener("focusout",(()=>{n.value="",n.blur(),l.classList.remove("d-none"),n.classList.add("d-none")})),s("/getListNames","GET",(async e=>{const t=await e.json();if(t&&t.names)for(let e=0;e<t.names.length;e++){const n=i(t.names[e]),l=n.querySelector("#headerBtn");l.addEventListener("click",(()=>{l.dataset.loaded||(l.dataset.loaded="true",s(`/getList?name=${l.textContent}`,"GET",(async e=>{const t=await e.json();if(t&&t.items)for(let e=0;e<t.items.length;e++)o(n,t.items[e]);n.querySelector("#listHiddenForLoading").classList.remove("d-none"),n.querySelector("#listLoadingSpinner").classList.add("d-none")})))}))}document.querySelector("#hiddenForLoading").classList.remove("d-none"),document.querySelector("#loadingSpinner").classList.add("d-none")}))}))})();